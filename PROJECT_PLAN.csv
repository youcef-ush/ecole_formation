ID,Module,Sous-Module,Tâche,Type,Composant,Fichier,Dépendances,Durée (h),Priorité,Statut,Notes
1,QR Code & Présences,1. Base de Données,Modifier Student.entity.ts - Ajouter champs QR,Backend,Entity,backend/src/entities/Student.entity.ts,Aucune,0.5,HAUTE,✅ TERMINÉ,"Ajouter: badgeQrCode, badgeExpiry, isActive, emergencyContact, schoolLevel"
2,QR Code & Présences,1. Base de Données,Modifier Session.entity.ts - Ajouter champs QR,Backend,Entity,backend/src/entities/Session.entity.ts,Aucune,0.5,HAUTE,✅ TERMINÉ,"Ajouter: sessionQrCode, qrExpiresAt, currentAttendance, isActive"
3,QR Code & Présences,1. Base de Données,Créer Attendance.entity.ts,Backend,Entity,backend/src/entities/Attendance.entity.ts,Tâche 1-2,1,HAUTE,✅ TERMINÉ,"Enums: ScanMethod, AttendanceStatus. Relations: Student, Session, User"
4,QR Code & Présences,1. Base de Données,Créer AttendanceReport.entity.ts,Backend,Entity,backend/src/entities/AttendanceReport.entity.ts,Tâche 3,0.5,MOYENNE,✅ TERMINÉ,"Stats mensuelles: totalSessions, presentCount, absentCount, lateCount, attendanceRate"
5,QR Code & Présences,1. Base de Données,Migration: add_qr_fields_to_students.sql,Backend,Migration,backend/migrations/add_qr_fields_to_students.sql,Tâche 1,0.5,HAUTE,✅ TERMINÉ,ALTER TABLE students + UPDATE existants
6,QR Code & Présences,1. Base de Données,Migration: add_qr_fields_to_sessions.sql,Backend,Migration,backend/migrations/add_qr_fields_to_sessions.sql,Tâche 2,0.5,HAUTE,✅ TERMINÉ,ALTER TABLE sessions
7,QR Code & Présences,1. Base de Données,Migration: create_attendances_table.sql,Backend,Migration,backend/migrations/create_attendances_table.sql,Tâche 3,0.5,HAUTE,✅ TERMINÉ,CREATE TABLE + index performances
8,QR Code & Présences,1. Base de Données,Migration: create_attendance_reports_table.sql,Backend,Migration,backend/migrations/create_attendance_reports_table.sql,Tâche 4,0.5,MOYENNE,✅ TERMINÉ,CREATE TABLE + contrainte unique (student-course-month-year)
9,QR Code & Présences,1. Base de Données,Exécuter toutes les migrations,Backend,Database,PostgreSQL,Tâche 5-8,0.5,HAUTE,✅ TERMINÉ,Vérifier pas d'erreurs. Backup BD avant
10,QR Code & Présences,1. Base de Données,Mettre à jour database.config.ts,Backend,Config,backend/src/config/database.config.ts,Tâche 3-4,0.25,HAUTE,✅ TERMINÉ,Ajouter nouvelles entités dans entities array
10.1,Architecture Sessions,1. Base de Données,Modifier Enrollment.entity.ts - Retirer sessionId,Backend,Entity,backend/src/entities/Enrollment.entity.ts,Aucune,0.5,HAUTE,✅ TERMINÉ,"Retirer sessionId, garder courseId. Enrollment→Formation (pas Session)"
10.2,Architecture Sessions,2. Services Backend,Créer SessionGeneratorService,Backend,Service,backend/src/services/session-generator.service.ts,Tâche 10.1,2.5,HAUTE,✅ TERMINÉ,"3 méthodes: generateSessionsForTutoring() 10 sessions Sep-Juin, generateSessionsForQualifying() N mois, generateSessionsForShort() 1-2 sessions"
10.3,Architecture Sessions,2. Services Backend,Adapter PaymentScheduleService,Backend,Service,backend/src/services/payment-schedule.service.ts,Tâche 10.2,2,HAUTE,✅ TERMINÉ,"3 patterns: TUTORING 10 paiements Sep-Juin, QUALIFYING_LONG N paiements, QUALIFYING_SHORT 50%+50%"
10.4,Architecture Sessions,3. API Routes,Modifier courses.routes.ts - Hook génération auto,Backend,Route,backend/src/routes/courses.routes.ts,Tâche 10.2-10.3,1,HAUTE,✅ TERMINÉ,"Dans POST /: après création Course, appeler SessionGeneratorService + PaymentScheduleService"
11,QR Code & Présences,2. Services Backend,Installer package qrcode,Backend,Package,package.json,Aucune,0.1,HAUTE,✅ TERMINÉ,npm install qrcode @types/qrcode
12,QR Code & Présences,2. Services Backend,Créer QrCodeService,Backend,Service,backend/src/services/qrcode.service.ts,Tâche 9-11,2,HAUTE,✅ TERMINÉ,"4 méthodes: generateStudentBadge, generateSessionQr, validateStudentQr, validateSessionQr"
13,QR Code & Présences,2. Services Backend,Créer AccessControlService,Backend,Service,backend/src/services/access-control.service.ts,Tâche 9-10.4,1.5,HAUTE,✅ TERMINÉ,"3 méthodes: checkStudentAccess, validatePaymentStatus, logAccessAttempt. Blocage après 15 jours"
14,QR Code & Présences,2. Services Backend,Créer AttendanceService,Backend,Service,backend/src/services/attendance.service.ts,Tâche 9-10.4,2,HAUTE,✅ TERMINÉ,"5 méthodes: recordAttendance, recordManualAttendance, generateDailyReport, checkRepeatedAbsences, updateMonthlyReport"
15,QR Code & Présences,3. API Routes,Créer attendance.routes.ts,Backend,Route,backend/src/routes/attendance.routes.ts,Tâche 12-14,2,HAUTE,✅ TERMINÉ,"4 endpoints: POST /validate-scan, POST /manual, GET /sessions/:id/attendance, POST /sessions/:id/generate-qr. Ajouté dans app.ts"
16,QR Code & Présences,3. API Routes,Modifier students.routes.ts - Endpoints badges,Backend,Route,backend/src/routes/students.routes.ts,Tâche 12,1,HAUTE,✅ TERMINÉ,"3 endpoints: POST /:id/generate-badge, PUT /:id/revoke-badge, GET /validate-badge/:qrCode"
17,QR Code & Présences,3. API Routes,Modifier registrations.routes.ts - Génération badge auto,Backend,Route,backend/src/routes/registrations.routes.ts,Tâche 12,1,HAUTE,✅ TERMINÉ,Dans POST /:id/validate: appelle generateStudentBadge() après création Student. Badge valide 12 mois
18,QR Code & Présences,3. API Routes,Mettre à jour app.ts,Backend,Config,backend/src/app.ts,Tâche 15,0.25,HAUTE,✅ TERMINÉ,Import et use attendance.routes (déjà fait avec Tâche 15)
19,QR Code & Présences,4. Frontend - Scanner,Installer package html5-qrcode,Frontend,Package,package.json,Aucune,0.1,HAUTE,✅ TERMINÉ,npm install html5-qrcode
20,QR Code & Présences,4. Frontend - Scanner,Créer QRScanner.tsx,Frontend,Page,frontend/src/pages/QRScanner.tsx,Tâche 19,3.5,HAUTE,✅ TERMINÉ,"2 étapes: 1) Sélection session manuelle (dropdown) 2) Scan badges étudiants. Feedback visuel/sonore (vert/rouge/orange). Liste présences temps réel. Dialog aide. MODIFIÉ: session sélectionnée via dropdown au lieu de scan QR"
21,QR Code & Présences,4. Frontend - Scanner,Ajouter sons feedback (beep),Frontend,Assets,frontend/public/sounds/,Aucune,0.25,HAUTE,✅ TERMINÉ,"Dossier créé. Fichiers à ajouter: beep-success.mp3, beep-error.mp3, beep-warning.mp3 (optionnel)"
22,QR Code & Présences,4. Frontend - Scanner,Ajouter route QR Scanner,Frontend,Config,frontend/src/App.tsx,Tâche 20,0.1,HAUTE,✅ TERMINÉ,<Route path="/qr-scanner" element={<QRScanner />} />
23,QR Code & Présences,4. Frontend - Scanner,Ajouter menu QR Scanner,Frontend,Component,frontend/src/components/Layout/Layout.tsx,Tâche 20,0.1,HAUTE,✅ TERMINÉ,MenuItem "Scanner Présences" avec icône QrCodeScanner (2ème position)
24,QR Code & Présences,5. Frontend - Gestion,Créer AttendanceManagement.tsx,Frontend,Page,frontend/src/pages/AttendanceManagement.tsx,Tâche 15,2.5,MOYENNE,✅ TERMINÉ,"Sélection session/date avec DatePicker @mui/x-date-pickers v6, stats détaillées (présents/absents/retard/excusés + taux), 2 onglets (Liste + Résumé), marquer présence manuelle (dialog), tableau filtrable"
25,QR Code & Présences,5. Frontend - Gestion,Ajouter route Attendance Management,Frontend,Config,frontend/src/App.tsx,Tâche 24,0.1,MOYENNE,✅ TERMINÉ,<Route path="/attendances" element={<AttendanceManagement />} />
26,QR Code & Présences,5. Frontend - Gestion,Ajouter menu Attendance Management,Frontend,Component,frontend/src/components/Layout/Layout.tsx,Tâche 24,0.1,MOYENNE,✅ TERMINÉ,MenuItem "Gestion Présences" avec icône CheckCircle (3ème position)
26.1,QR Code & Présences,5. Frontend - Gestion,Installer dépendances DatePicker,Frontend,Package,package.json,Tâche 24,0.15,MOYENNE,✅ TERMINÉ,"npm install @mui/x-date-pickers@^6.19.0 date-fns@^2.30.0 (compatibilité versions)"
27,QR Code & Présences,5. Frontend - Gestion,Modifier StudentDetail.tsx - Badge backend,Frontend,Page,frontend/src/pages/StudentDetail.tsx,Tâche 16,1,HAUTE,✅ TERMINÉ,"Afficher student.badgeQrCode depuis backend (image QR). Afficher student.badgeExpiry avec indicateur expiré/valide. Boutons: Générer/Renouveler badge (POST /students/:id/generate-badge), Révoquer badge (PUT /students/:id/revoke-badge). Badge utilisé dans BadgeCard pour impression"
28,QR Code & Présences,6. Dashboard Stats,Widget Taux Présence Global,Frontend,Component,frontend/src/pages/Dashboard.tsx,Tâche 14,1,MOYENNE,✅ TERMINÉ,"Card avec pourcentage présence tous étudiants. Couleur dynamique (vert ≥80%, orange ≥60%, rouge <60%). Affiche totalAttendances/totalSessions depuis API"
29,QR Code & Présences,6. Dashboard Stats,Widget Alertes Absences Répétées,Frontend,Component,frontend/src/pages/Dashboard.tsx,Tâche 14,1,MOYENNE,✅ TERMINÉ,"Tableau top 5 étudiants absences répétées (≥3). Colonnes: Étudiant, Absences totales, Consécutives. Chips colorés (rouge ≥3 consécutives). Affiche date dernière absence"
30,QR Code & Présences,6. Dashboard Stats,Endpoint dashboard stats,Backend,Route,backend/src/routes/dashboard.routes.ts,Tâche 14,1,MOYENNE,✅ TERMINÉ,"GET /api/dashboard/attendance-stats. Retourne: totalSessions, totalAttendances, attendanceRate (%), absentStudents[] (top 5 avec ≥3 absences, calcul absences consécutives). Query complexe avec GROUP BY et HAVING"
31,QR Code & Présences,7. Tests & Validation,Test: Génération badge lors inscription,Test,Backend,Postman/Thunder,Tâche 17,0.5,HAUTE,À faire,POST /registrations/:id/validate → vérifier student.badgeQrCode créé
32,QR Code & Présences,7. Tests & Validation,Test: Validation QR étudiant,Test,Backend,Postman/Thunder,Tâche 16,0.5,HAUTE,À faire,GET /students/validate-badge/:qrCode
33,QR Code & Présences,7. Tests & Validation,Test: Génération QR session,Test,Backend,Postman/Thunder,Tâche 15,0.5,HAUTE,À faire,POST /sessions/:id/generate-qr
34,QR Code & Présences,7. Tests & Validation,Test: Scan QR complet (succès),Test,Frontend,Navigation,Tâche 20,0.5,HAUTE,À faire,Scanner QR session + QR étudiant valide → présence enregistrée
35,QR Code & Présences,7. Tests & Validation,Test: Blocage paiement retard 15j,Test,Integration,BD + API,Tâche 13,0.5,HAUTE,À faire,Créer échéance 16j retard → scan QR → vérifier blocage orange
36,QR Code & Présences,7. Tests & Validation,Test: Présence manuelle (admin),Test,Backend,Postman/Thunder,Tâche 15,0.25,HAUTE,À faire,POST /attendance/manual
37,QR Code & Présences,7. Tests & Validation,Test: Badge expiré,Test,Integration,BD + Frontend,Tâche 12,0.5,HAUTE,À faire,Modifier badgeExpiry à date passée → scan → vérifier erreur
38,QR Code & Présences,7. Tests & Validation,Test: Session QR expiré,Test,Integration,BD + Frontend,Tâche 12,0.5,HAUTE,À faire,Modifier qrExpiresAt à date passée → scan → vérifier erreur
39,QR Code & Présences,7. Tests & Validation,Test: Étudiant non inscrit session,Test,Integration,BD + Frontend,Tâche 13,0.5,HAUTE,À faire,Scanner QR étudiant pour session non inscrite → vérifier refus
40,QR Code & Présences,7. Tests & Validation,Test: Rapport quotidien présences,Test,Backend,Postman/Thunder,Tâche 14-15,0.5,MOYENNE,À faire,GET /sessions/:id/attendance?date=2025-11-10
41,QR Code & Présences,7. Tests & Validation,Test: Stats mensuelles auto-générées,Test,Backend,BD,Tâche 14,0.5,MOYENNE,À faire,Enregistrer plusieurs présences → vérifier attendance_reports mis à jour
42,QR Code & Présences,8. Documentation,Documenter API attendance,Doc,Markdown,backend/ATTENDANCE_API.md,Tâche 15,0.5,MOYENNE,À faire,"Tous endpoints, exemples requêtes/réponses, codes erreur"
43,QR Code & Présences,8. Documentation,Documenter workflow scan QR,Doc,Markdown,WORKFLOW_QR_SCAN.md,Tâche 20,0.5,MOYENNE,À faire,"Diagrammes, étapes, gestion erreurs"
44,QR Code & Présences,8. Documentation,Guide utilisateur Scanner QR,Doc,Markdown,USER_GUIDE_QR.md,Tâche 20,0.5,BASSE,À faire,Screenshots et instructions pour admins
45,QR Code & Présences,8. Documentation,Mettre à jour REFACTORING_PLAN.md,Doc,Markdown,REFACTORING_PLAN.md,Toutes,0.25,BASSE,À faire,Marquer tâches complétées
